name: Ethereum Testnet CI
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  testnet:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Deploy to Testnet
      shell: bash
      run: |
        mkdir -p nodes/node1/data
        
        docker compose up -d eth-node1
        
        echo "=== Node startup (120s wait) ==="
        sleep 120
        
        echo "=== Final logs ==="
        docker compose logs --tail=30 eth-node1
        
        for i in {1..10}; do
          echo "RPC test $i..."
          response=$(curl -s -w "%{http_code}" -X POST -H "Content-Type: application/json" \
            --data '{"jsonrpc":"2.0","method":"web3_clientVersion","params":[],"id":1}' \
            http://localhost:8545)
          
          if [[ $response
